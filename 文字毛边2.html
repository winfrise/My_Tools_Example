<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Canvas çº¯å™ªç‚¹çº¹ç†å åŠ  æ— åç§» æ¯›è¾¹çˆ†ç‚¸æ˜æ˜¾ å°ç« æ–‡å­—ç»ˆæç‰ˆ</title>
  <style>canvas { border: 1px solid #eee; background: #fff; }</style>
</head>
<body>
<canvas id="canvas" width="400" height="400"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
// ===== ğŸ”¥ çº¯çº¹ç†æ¯›è¾¹æ ¸å¿ƒå‚æ•° æ‹‰æ»¡ æ— åç§» æ¯›è¾¹ç»å¯¹æ˜æ˜¾ =====
const centerX = 200, centerY = 200;
const outRadius = 150;
const inRadius = 138;
const lineWidth = 4;
const text = "ç¦";
const textFontSize = 95;
const GLOBAL_COLOR = '#c02f23'; // å°ç« æ­£çº¢ æ— æ‚è‰²
const GLOBAL_ROUGH = 22;        // âœ… çº¹ç†é¢—ç²’å¤§å° æ‹‰æ»¡ï¼çº¯çº¹ç†æ¯›è¾¹çš„æ ¸å¿ƒï¼Œè¶Šå¤§æ¯›è¾¹è¶Šç²—è¶Šæ˜æ˜¾
const NOISE_OPACITY = 1.0;      // âœ… çº¹ç†ä¸é€æ˜åº¦ æ‹‰æ»¡ æ— è¡°å‡ ä¾µèš€æ•ˆæœæœ€å¼º
const FLY_OPACITY = 0.4;        // âœ… é£ç™½æµ“åº¦ é€‚ä¸­ä¿ç•™ ä¸æ©ç›–æ¯›è¾¹

// ===== âœ… æ ¸å¿ƒã€è¶…å¤§é¢—ç²’ æš´åŠ›ä¾µèš€ã€‘å°ç« åŒæ¬¾å™ªç‚¹çº¹ç† (æ–‡å­—+å°ç« å…±ç”¨ 1:1è´¨æ„Ÿ) =====
// çº¹ç†æ˜¯æ¯›è¾¹çš„å”¯ä¸€æ¥æºï¼Œæ— ä»»ä½•å…¶ä»–é€»è¾‘ï¼Œé¢—ç²’è¶Šå¤§ã€å¯†åº¦è¶Šé«˜ â†’ æ¯›è¾¹è¶Šæ˜æ˜¾
function createPureSealTexture() {
  const tex = document.createElement('canvas');
  tex.width = 32;  // çº¹ç†ç”»å¸ƒæ”¾å¤§ é¢—ç²’è¶…å¤§ è‚‰çœ¼æ¸…æ™°
  tex.height = 32;
  const tctx = tex.getContext('2d');
  tctx.fillStyle = 'rgba(0,0,0,0)';
  tctx.fillRect(0,0,32,32);

  // 1. å°ç« çº¢å®å¿ƒç²—é¢—ç²’ â†’ å½¢æˆæ¯›è¾¹çš„ã€Œå¤–æº¢å¢¨è¿¹ã€å‡¸èµ·é¢—ç²’
  for(let i=0; i<120; i++){
    const x = Math.random()*32;
    const y = Math.random()*32;
    const size = Math.random()*6 + 3; // è¶…å¤§çº¢è‰²é¢—ç²’ å¤–æº¢æ›´æ˜æ˜¾
    tctx.fillStyle = GLOBAL_COLOR;
    tctx.fillRect(x, y, size, size);
  }

  // 2. çº¯é»‘å®å¿ƒè¶…ç²—é¢—ç²’ â†’ å½¢æˆæ¯›è¾¹çš„ã€Œå’¬è¾¹ç¼ºå£ã€æ ¸å¿ƒ å°ºå¯¸ç”±GLOBAL_ROUGHæ§åˆ¶
  // è¿™æ˜¯çº¯çº¹ç†æ¯›è¾¹çš„çµé­‚ï¼šçº¯é»‘é¢—ç²’ç›´æ¥åƒæ‰æ–‡å­—è¾¹ç¼˜ï¼Œå½¢æˆä¸è§„åˆ™æ¯›è¾¹ï¼Œæ— ä»»ä½•åç§»
  for(let i=0; i<90; i++){
    const x = Math.random()*32;
    const y = Math.random()*32;
    const size = Math.random()*GLOBAL_ROUGH + 5; // âœ… æš´åŠ›ä¾µèš€ é¢—ç²’è¶…å¤§ æ¯›è¾¹å¿…æ˜¾
    tctx.fillStyle = 'rgba(0,0,0,1)'; // çº¯é»‘ä¸é€æ˜ æ— ä»»ä½•é€æ˜åº¦æŠµæ¶ˆ ä¾µèš€æ•ˆæœæ‹‰æ»¡
    tctx.fillRect(x, y, size, size);
  }
  return ctx.createPattern(tex, 'repeat');
}

// ===== âœ… ç»˜åˆ¶ çº¯çº¹ç†ä¾µèš€æ¯›è¾¹ åŒçº¿å°ç«  (æ— åç§» çº¯çº¹ç† å’Œæ–‡å­—è´¨æ„Ÿ1:1) =====
function drawDoubleSeal() {
  // ç»˜åˆ¶æ— åç§»çš„æ ‡å‡†åŒåœ†è·¯å¾„ (æ— ä»»ä½•éšæœºæŠ–åŠ¨ï¼Œçº¯çº¹ç†ä¾µèš€å‡ºæ¯›è¾¹)
  ctx.beginPath();
  ctx.arc(centerX, centerY, outRadius, 0, Math.PI*2);
  ctx.closePath();
  ctx.beginPath();
  ctx.arc(centerX, centerY, inRadius, 0, Math.PI*2);
  ctx.closePath();

  // å°ç« åŸºç¡€æ ·å¼
  ctx.lineWidth = lineWidth;
  ctx.strokeStyle = GLOBAL_COLOR;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  ctx.stroke();

  // âœ… çº¯çº¹ç†å åŠ ä¾µèš€å°ç« è¾¹ç¼˜ â†’ å°ç« æ¯›è¾¹ 100%æ¥è‡ªçº¹ç† æ— åç§»
  ctx.globalCompositeOperation = 'destination-out';
  ctx.globalAlpha = NOISE_OPACITY;
  ctx.strokeStyle = createPureSealTexture();
  ctx.stroke();

  // å¤ä½æ··åˆæ¨¡å¼
  ctx.globalCompositeOperation = 'source-over';
  ctx.globalAlpha = 1;
}

// ===== âœ… âœ”ï¸ é‡ä¸­ä¹‹é‡ï¼šçº¯å™ªç‚¹çº¹ç†å åŠ æ³• ç»˜åˆ¶æ–‡å­— (æ— ä»»ä½•åç§»ï¼æ— dx/dyï¼æ— å¤šå±‚ä½ç§»ï¼) =====
// âœ… æ ¸å¿ƒæ‰¿è¯ºï¼šæ­¤å‡½æ•°å†… æ— ä»»ä½• x+éšæœºæ•° / y+éšæœºæ•° çš„å†™æ³•
// âœ… æ–‡å­—æ¯›è¾¹ï¼š100% ç”±å™ªç‚¹çº¹ç†çš„ä¾µèš€+æ··åˆæ¨¡å¼å®ç°ï¼Œä½ç½®æ°¸è¿œå›ºå®šï¼Œæ¯›è¾¹æ¥è‡ªçº¹ç†æœ¬èº«
// âœ… æ¯›è¾¹æ•ˆæœï¼šçˆ†ç‚¸çº§æ˜æ˜¾ï¼Œæ–‡å­—è¾¹ç¼˜å…¨æ˜¯é¢—ç²’çŠ¶å’¬è¾¹ï¼Œè‚‰çœ¼ç»å¯¹æ¸…æ™°å¯è§
function drawPureNoiseText() {
  ctx.save();
  // å›ºå®šå­—ä½“ å›ºå®šä½ç½® æ— ä»»ä½•åç§»
  ctx.font = `bold ${textFontSize}px å®‹ä½“, æ¥·ä½“, é»‘ä½“`;
  const textWidth = ctx.measureText(text).width;
  const fixX = centerX - textWidth / 2; // ç²¾å‡†å±…ä¸­X å›ºå®šä¸å˜
  const fixY = centerY + 28;            // ç²¾å‡†å±…ä¸­Y å›ºå®šä¸å˜
  ctx.fillStyle = GLOBAL_COLOR;

  // ========== æ­¥éª¤1ï¼šç»˜åˆ¶ã€å›ºå®šä½ç½®ã€‘å®å¿ƒæ–‡å­—æ‰“åº• ç¬”ç”»æ‰å® æ— ä»»ä½•åç§» ==========
  ctx.globalAlpha = 1;
  ctx.fillText(text, fixX, fixY);

  // ========== æ­¥éª¤2ï¼šã€æ ¸å¼¹çº§æ ¸å¿ƒ çº¯çº¹ç†æ¯›è¾¹ã€‘æ— åç§» å›ºå®šä½ç½®å åŠ çº¹ç† æš´åŠ›ä¾µèš€ âœ”ï¸âœ”ï¸âœ”ï¸
  // è¿™ä¸€æ­¥æ˜¯çº¯çº¹ç†æ¯›è¾¹çš„å…¨éƒ¨æ¥æºï¼Œæ— ä»»ä½•å…¶ä»–é€»è¾‘ï¼Œæ¯›è¾¹æ•ˆæœå…¨é è¿™ä¸€æ­¥
  // destination-out æ··åˆæ¨¡å¼ï¼šçº¹ç†çš„é»‘è‰²é¢—ç²’ä¼šç›´æ¥ã€Œå•ƒæ‰/ä¾µèš€ã€æ–‡å­—è¾¹ç¼˜åƒç´ 
  // å› ä¸ºæ— åç§»ï¼Œçº¹ç†é¢—ç²’çš„ä¸è§„åˆ™æ€§ â†’ å½¢æˆè‡ªç„¶ã€ç²—çŠ·ã€é¢—ç²’çŠ¶çš„å°ç« æ¯›è¾¹
  ctx.globalCompositeOperation = 'destination-out';
  ctx.globalAlpha = NOISE_OPACITY;
  ctx.fillStyle = createPureSealTexture();
  ctx.fillText(text, fixX, fixY); // âœ… æ— ä»»ä½•åç§»ï¼å›ºå®šåæ ‡ç»˜åˆ¶çº¹ç† çº¯çº¹ç†ä¾µèš€

  // ========== æ­¥éª¤3ï¼šå åŠ ä¸€å±‚å°ç« çº¢çº¹ç†è¡¥è¾¹ å¼ºåŒ–æ¯›è¾¹é¢—ç²’æ„Ÿ è®©æ¯›è¾¹æ›´çªå‡º ==========
  // æ— åç§» å›ºå®šä½ç½® çº¯çº¹ç†å åŠ  æ¯›è¾¹è½®å»“æ›´æ¸…æ™° é¢—ç²’æ„Ÿæ›´è¶³
  ctx.globalCompositeOperation = 'source-atop';
  ctx.globalAlpha = 0.9;
  ctx.fillStyle = createPureSealTexture();
  ctx.fillText(text, fixX, fixY); // âœ… ä¾æ—§æ— åç§»ï¼

  // ========== æ­¥éª¤4ï¼šä¿ç•™é£ç™½æ–­å¢¨æ•ˆæœ çº¯é€æ˜åº¦æ§åˆ¶ æ— åç§» ==========
  ctx.globalCompositeOperation = 'destination-out';
  ctx.globalAlpha = FLY_OPACITY;
  ctx.fillStyle = 'rgba(0,0,0,0.8)';
  ctx.fillText(text, fixX, fixY); // âœ… æ— åç§»ï¼é£ç™½ä¹Ÿæ˜¯çº¯çº¹ç†+é€æ˜åº¦ æ— ä½ç§»

  // ========== æ­¥éª¤5ï¼šè¡¥ä¸€å±‚å®è‰²æ–‡å­— å¼ºåŒ–ç¬”ç”»ä¸»ä½“ æ¯›è¾¹å¯¹æ¯”æ›´å¼ºçƒˆ ==========
  ctx.globalCompositeOperation = 'source-over';
  ctx.globalAlpha = 0.85;
  ctx.fillStyle = GLOBAL_COLOR;
  ctx.fillText(text, fixX, fixY); // âœ… æœ€ç»ˆå›ºå®šä½ç½® æ— ä»»ä½•åç§»ï¼

  ctx.restore();
}

// æ‰§è¡Œç»˜åˆ¶ é¡ºåºä¸å˜
drawDoubleSeal();
drawPureNoiseText();
</script>
</body>
</html>